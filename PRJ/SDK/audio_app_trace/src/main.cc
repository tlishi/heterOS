#include "headers.h"
#include <math.h>
#include "xscugic.h"
#include "sleep.h"

#include "circularBuffer.h"
#include <vector>
//

using namespace std;

//RTC中断使用，暂时废弃
//#define SCUGIC_ID XPAR_SCUGIC_0_DEVICE_ID //中断控制器 ID
//#define GPIO_INT_ID 61U

//PS计时器中断使用
#define TIMER_DEVICE_ID     XPAR_XSCUTIMER_0_DEVICE_ID   //定时器ID
#define INTC_DEVICE_ID      XPAR_SCUGIC_SINGLE_DEVICE_ID //中断ID
#define TIMER_IRPT_INTR     XPAR_SCUTIMER_INTR           //定时器中断ID
//私有定时器的时钟频率 = CPU时钟频率/2 = 333MHz
//10s一次,10*1000_000_000/(1000/333) - 1 = C67BC480
#define TIMER_LOAD_VALUE    0xC67BC480                    //定时器装载值

/* ---------------------------------------------------------------------------- *
 * 									main()										*
 * ---------------------------------------------------------------------------- *
 * Runs all initial setup functions to initialise the audio codec and IP
 * peripherals, before calling the interactive menu system.
 * ---------------------------------------------------------------------------- */
/* ---------------------------------------------------------------------------- *
 * 							Global Variables									*
 * ---------------------------------------------------------------------------- */
//RTC中断使用，暂时废弃
//XScuGic scugic_inst; //中断控制器 驱动实例
//XScuGic_Config * scugic_cfg_ptr; //中断控制器 配置信息
//PS计时器中断使用
XScuGic Intc;               //中断控制器驱动程序实例
XScuTimer Timer;            //定时器驱动程序实例

#define RTCTIMER_CD_SEC 120
#define STRENGTH 0.045

u64 outdata[MAX_PKT_LEN]  __attribute__ ((aligned(64)));;
u64 sampledata[MAX_PKT_LEN]  __attribute__ ((aligned(64)));;
u64 sampledata_modify[MAX_PKT_LEN]  __attribute__ ((aligned(64)));;
u64 sampledata_fft[MAX_PKT_LEN]  __attribute__ ((aligned(64)));;
u64 delta_fft[MAX_PKT_LEN]  __attribute__ ((aligned(64)));;
float delta_out[MAX_PKT_LEN];

void* aligned_malloc(size_t required_bytes, size_t alignment)
{
    int offset = alignment - 1 + sizeof(void*);
    void* p1 = (void*)malloc(required_bytes + offset);
    if (p1 == NULL)
        return NULL;

    void** p2 = (void**)( ( (size_t)p1 + offset ) & ~(alignment - 1) );
    p2[-1] = p1;

    return p2;
}

void aligned_free(void *p2)
{
    void* p1 = ((void**)p2)[-1];
    free(p1);
}

float remainPatch[MAX_PKT_LEN];
float beforePatch[MAX_PKT_LEN];
float middPatch[MAX_PKT_LEN];
float lastPatch[MAX_PKT_LEN];

int yy,mm,dd,hh,minute;
char gloabl_mark_string[20];


//u32 window[1024] = { 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 25, 25, 25, 25, 26, 26, 26, 26, 27, 27, 27, 27, 28, 28, 28, 28, 29, 29, 29, 30, 30, 30, 30, 31, 31, 31, 32, 32, 32, 33, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 37, 38, 38, 38, 39, 39, 40, 40, 40, 41, 41, 42, 42, 42, 43, 43, 44, 44, 45, 45, 45, 46, 46, 47, 47, 48, 48, 49, 49, 49, 50, 50, 51, 51, 52, 52, 53, 53, 54, 54, 55, 55, 56, 56, 57, 57, 58, 58, 59, 59, 60, 60, 61, 61, 62, 63, 63, 64, 64, 65, 65, 66, 66, 67, 67, 68, 69, 69, 70, 70, 71, 71, 72, 73, 73, 74, 74, 75, 76, 76, 77, 77, 78, 78, 79, 80, 80, 81, 81, 82, 83, 83, 84, 85, 85, 86, 86, 87, 88, 88, 89, 90, 90, 91, 91, 92, 93, 93, 94, 95, 95, 96, 96, 97, 98, 98, 99, 100, 100, 101, 102, 102, 103, 104, 104, 105, 106, 106, 107, 108, 108, 109, 110, 110, 111, 112, 112, 113, 113, 114, 115, 115, 116, 117, 117, 118, 119, 119, 120, 121, 121, 122, 123, 123, 124, 125, 125, 126, 127, 128, 128, 129, 130, 130, 131, 132, 132, 133, 134, 134, 135, 136, 136, 137, 138, 138, 139, 140, 140, 141, 142, 142, 143, 143, 144, 145, 145, 146, 147, 147, 148, 149, 149, 150, 151, 151, 152, 153, 153, 154, 155, 155, 156, 157, 157, 158, 159, 159, 160, 160, 161, 162, 162, 163, 164, 164, 165, 165, 166, 167, 167, 168, 169, 169, 170, 170, 171, 172, 172, 173, 174, 174, 175, 175, 176, 177, 177, 178, 178, 179, 179, 180, 181, 181, 182, 182, 183, 184, 184, 185, 185, 186, 186, 187, 188, 188, 189, 189, 190, 190, 191, 191, 192, 192, 193, 194, 194, 195, 195, 196, 196, 197, 197, 198, 198, 199, 199, 200, 200, 201, 201, 202, 202, 203, 203, 204, 204, 205, 205, 206, 206, 206, 207, 207, 208, 208, 209, 209, 210, 210, 210, 211, 211, 212, 212, 213, 213, 213, 214, 214, 215, 215, 215, 216, 216, 217, 217, 217, 218, 218, 219, 219, 219, 220, 220, 220, 221, 221, 221, 222, 222, 222, 223, 223, 223, 224, 224, 224, 225, 225, 225, 225, 226, 226, 226, 227, 227, 227, 227, 228, 228, 228, 228, 229, 229, 229, 229, 230, 230, 230, 230, 231, 231, 231, 231, 231, 232, 232, 232, 232, 232, 233, 233, 233, 233, 233, 233, 234, 234, 234, 234, 234, 234, 234, 235, 235, 235, 235, 235, 235, 235, 235, 235, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 237, 237, 237, 237, 237, 237, 237, 237, 237, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 236, 235, 235, 235, 235, 235, 235, 235, 235, 235, 234, 234, 234, 234, 234, 234, 234, 233, 233, 233, 233, 233, 233, 232, 232, 232, 232, 232, 231, 231, 231, 231, 231, 230, 230, 230, 230, 229, 229, 229, 229, 228, 228, 228, 228, 227, 227, 227, 227, 226, 226, 226, 225, 225, 225, 225, 224, 224, 224, 223, 223, 223, 222, 222, 222, 221, 221, 221, 220, 220, 220, 219, 219, 219, 218, 218, 217, 217, 217, 216, 216, 215, 215, 215, 214, 214, 213, 213, 213, 212, 212, 211, 211, 210, 210, 210, 209, 209, 208, 208, 207, 207, 206, 206, 206, 205, 205, 204, 204, 203, 203, 202, 202, 201, 201, 200, 200, 199, 199, 198, 198, 197, 197, 196, 196, 195, 195, 194, 194, 193, 192, 192, 191, 191, 190, 190, 189, 189, 188, 188, 187, 186, 186, 185, 185, 184, 184, 183, 182, 182, 181, 181, 180, 179, 179, 178, 178, 177, 177, 176, 175, 175, 174, 174, 173, 172, 172, 171, 170, 170, 169, 169, 168, 167, 167, 166, 165, 165, 164, 164, 163, 162, 162, 161, 160, 160, 159, 159, 158, 157, 157, 156, 155, 155, 154, 153, 153, 152, 151, 151, 150, 149, 149, 148, 147, 147, 146, 145, 145, 144, 143, 143, 142, 142, 141, 140, 140, 139, 138, 138, 137, 136, 136, 135, 134, 134, 133, 132, 132, 131, 130, 130, 129, 128, 128, 127, 126, 125, 125, 124, 123, 123, 122, 121, 121, 120, 119, 119, 118, 117, 117, 116, 115, 115, 114, 113, 113, 112, 112, 111, 110, 110, 109, 108, 108, 107, 106, 106, 105, 104, 104, 103, 102, 102, 101, 100, 100, 99, 98, 98, 97, 96, 96, 95, 95, 94, 93, 93, 92, 91, 91, 90, 90, 89, 88, 88, 87, 86, 86, 85, 85, 84, 83, 83, 82, 81, 81, 80, 80, 79, 78, 78, 77, 77, 76, 76, 75, 74, 74, 73, 73, 72, 71, 71, 70, 70, 69, 69, 68, 67, 67, 66, 66, 65, 65, 64, 64, 63, 63, 62, 61, 61, 60, 60, 59, 59, 58, 58, 57, 57, 56, 56, 55, 55, 54, 54, 53, 53, 52, 52, 51, 51, 50, 50, 49, 49, 49, 48, 48, 47, 47, 46, 46, 45, 45, 45, 44, 44, 43, 43, 42, 42, 42, 41, 41, 40, 40, 40, 39, 39, 38, 38, 38, 37, 37, 36, 36, 36, 35, 35, 35, 34, 34, 34, 33, 33, 33, 32, 32, 32, 31, 31, 31, 30, 30, 30, 30, 29, 29, 29, 28, 28, 28, 28, 27, 27, 27, 27, 26, 26, 26, 26, 25, 25, 25, 25, 24, 24, 24, 24, 24, 23, 23, 23, 23, 23, 22, 22, 22, 22, 22, 22, 21, 21, 21, 21, 21, 21, 21, 20, 20, 20, 20, 20, 20, 20, 20, 20, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 18, 18, 18, 18 };
float window[1024]={0.000289,0.000289,0.000289,0.000290,0.000290,0.000290,0.000290,0.000291,0.000291,0.000292,0.000292,0.000293,0.000294,0.000295,0.000295,0.000296,0.000297,0.000298,0.000299,0.000301,0.000302,0.000303,0.000304,0.000306,0.000307,0.000309,0.000310,0.000312,0.000314,0.000316,0.000317,0.000319,0.000321,0.000323,0.000325,0.000328,0.000330,0.000332,0.000334,0.000337,0.000339,0.000342,0.000344,0.000347,0.000350,0.000352,0.000355,0.000358,0.000361,0.000364,0.000367,0.000370,0.000373,0.000377,0.000380,0.000383,0.000387,0.000390,0.000394,0.000397,0.000401,0.000405,0.000408,0.000412,0.000416,0.000420,0.000424,0.000428,0.000432,0.000436,0.000440,0.000445,0.000449,0.000453,0.000458,0.000462,0.000467,0.000472,0.000476,0.000481,0.000486,0.000491,0.000496,0.000500,0.000505,0.000511,0.000516,0.000521,0.000526,0.000531,0.000537,0.000542,0.000547,0.000553,0.000559,0.000564,0.000570,0.000575,0.000581,0.000587,0.000593,0.000599,0.000605,0.000611,0.000617,0.000623,0.000629,0.000635,0.000641,0.000648,0.000654,0.000661,0.000667,0.000674,0.000680,0.000687,0.000693,0.000700,0.000707,0.000714,0.000720,0.000727,0.000734,0.000741,0.000748,0.000755,0.000762,0.000769,0.000777,0.000784,0.000791,0.000799,0.000806,0.000813,0.000821,0.000828,0.000836,0.000843,0.000851,0.000859,0.000866,0.000874,0.000882,0.000890,0.000898,0.000906,0.000914,0.000921,0.000930,0.000938,0.000946,0.000954,0.000962,0.000970,0.000978,0.000987,0.000995,0.001003,0.001012,0.001020,0.001029,0.001037,0.001046,0.001054,0.001063,0.001072,0.001080,0.001089,0.001098,0.001107,0.001115,0.001124,0.001133,0.001142,0.001151,0.001160,0.001169,0.001178,0.001187,0.001196,0.001205,0.001214,0.001223,0.001233,0.001242,0.001251,0.001260,0.001270,0.001279,0.001288,0.001298,0.001307,0.001316,0.001326,0.001335,0.001345,0.001354,0.001364,0.001373,0.001383,0.001393,0.001402,0.001412,0.001422,0.001431,0.001441,0.001451,0.001460,0.001470,0.001480,0.001490,0.001500,0.001509,0.001519,0.001529,0.001539,0.001549,0.001559,0.001569,0.001579,0.001589,0.001599,0.001609,0.001619,0.001629,0.001639,0.001649,0.001659,0.001669,0.001679,0.001689,0.001699,0.001709,0.001719,0.001729,0.001739,0.001749,0.001760,0.001770,0.001780,0.001790,0.001800,0.001810,0.001821,0.001831,0.001841,0.001851,0.001861,0.001871,0.001882,0.001892,0.001902,0.001912,0.001923,0.001933,0.001943,0.001953,0.001963,0.001974,0.001984,0.001994,0.002004,0.002014,0.002025,0.002035,0.002045,0.002055,0.002065,0.002076,0.002086,0.002096,0.002106,0.002116,0.002126,0.002137,0.002147,0.002157,0.002167,0.002177,0.002187,0.002197,0.002207,0.002217,0.002228,0.002238,0.002248,0.002258,0.002268,0.002278,0.002288,0.002298,0.002308,0.002318,0.002328,0.002338,0.002347,0.002357,0.002367,0.002377,0.002387,0.002397,0.002407,0.002417,0.002426,0.002436,0.002446,0.002456,0.002465,0.002475,0.002485,0.002494,0.002504,0.002514,0.002523,0.002533,0.002542,0.002552,0.002561,0.002571,0.002580,0.002590,0.002599,0.002609,0.002618,0.002627,0.002637,0.002646,0.002655,0.002664,0.002674,0.002683,0.002692,0.002701,0.002710,0.002719,0.002728,0.002737,0.002746,0.002755,0.002764,0.002773,0.002782,0.002791,0.002800,0.002808,0.002817,0.002826,0.002835,0.002843,0.002852,0.002860,0.002869,0.002877,0.002886,0.002894,0.002903,0.002911,0.002919,0.002928,0.002936,0.002944,0.002952,0.002961,0.002969,0.002977,0.002985,0.002993,0.003001,0.003009,0.003016,0.003024,0.003032,0.003040,0.003048,0.003055,0.003063,0.003070,0.003078,0.003085,0.003093,0.003100,0.003108,0.003115,0.003122,0.003130,0.003137,0.003144,0.003151,0.003158,0.003165,0.003172,0.003179,0.003186,0.003193,0.003200,0.003206,0.003213,0.003220,0.003226,0.003233,0.003239,0.003246,0.003252,0.003258,0.003265,0.003271,0.003277,0.003283,0.003289,0.003296,0.003302,0.003307,0.003313,0.003319,0.003325,0.003331,0.003337,0.003342,0.003348,0.003353,0.003359,0.003364,0.003370,0.003375,0.003380,0.003385,0.003391,0.003396,0.003401,0.003406,0.003411,0.003416,0.003420,0.003425,0.003430,0.003435,0.003439,0.003444,0.003448,0.003453,0.003457,0.003461,0.003466,0.003470,0.003474,0.003478,0.003482,0.003486,0.003490,0.003494,0.003498,0.003502,0.003505,0.003509,0.003513,0.003516,0.003520,0.003523,0.003526,0.003530,0.003533,0.003536,0.003539,0.003542,0.003545,0.003548,0.003551,0.003554,0.003557,0.003559,0.003562,0.003565,0.003567,0.003569,0.003572,0.003574,0.003576,0.003579,0.003581,0.003583,0.003585,0.003587,0.003589,0.003591,0.003592,0.003594,0.003596,0.003597,0.003599,0.003600,0.003602,0.003603,0.003604,0.003606,0.003607,0.003608,0.003609,0.003610,0.003611,0.003612,0.003612,0.003613,0.003614,0.003614,0.003615,0.003615,0.003616,0.003616,0.003616,0.003617,0.003617,0.003617,0.003617,0.003617,0.003617,0.003617,0.003616,0.003616,0.003616,0.003615,0.003615,0.003614,0.003614,0.003613,0.003612,0.003612,0.003611,0.003610,0.003609,0.003608,0.003607,0.003606,0.003604,0.003603,0.003602,0.003600,0.003599,0.003597,0.003596,0.003594,0.003592,0.003591,0.003589,0.003587,0.003585,0.003583,0.003581,0.003579,0.003576,0.003574,0.003572,0.003569,0.003567,0.003565,0.003562,0.003559,0.003557,0.003554,0.003551,0.003548,0.003545,0.003542,0.003539,0.003536,0.003533,0.003530,0.003526,0.003523,0.003520,0.003516,0.003513,0.003509,0.003505,0.003502,0.003498,0.003494,0.003490,0.003486,0.003482,0.003478,0.003474,0.003470,0.003466,0.003461,0.003457,0.003453,0.003448,0.003444,0.003439,0.003435,0.003430,0.003425,0.003420,0.003416,0.003411,0.003406,0.003401,0.003396,0.003391,0.003385,0.003380,0.003375,0.003370,0.003364,0.003359,0.003353,0.003348,0.003342,0.003337,0.003331,0.003325,0.003319,0.003313,0.003307,0.003302,0.003296,0.003289,0.003283,0.003277,0.003271,0.003265,0.003258,0.003252,0.003246,0.003239,0.003233,0.003226,0.003220,0.003213,0.003206,0.003200,0.003193,0.003186,0.003179,0.003172,0.003165,0.003158,0.003151,0.003144,0.003137,0.003130,0.003122,0.003115,0.003108,0.003100,0.003093,0.003085,0.003078,0.003070,0.003063,0.003055,0.003048,0.003040,0.003032,0.003024,0.003016,0.003009,0.003001,0.002993,0.002985,0.002977,0.002969,0.002961,0.002952,0.002944,0.002936,0.002928,0.002919,0.002911,0.002903,0.002894,0.002886,0.002877,0.002869,0.002860,0.002852,0.002843,0.002835,0.002826,0.002817,0.002808,0.002800,0.002791,0.002782,0.002773,0.002764,0.002755,0.002746,0.002737,0.002728,0.002719,0.002710,0.002701,0.002692,0.002683,0.002674,0.002664,0.002655,0.002646,0.002637,0.002627,0.002618,0.002609,0.002599,0.002590,0.002580,0.002571,0.002561,0.002552,0.002542,0.002533,0.002523,0.002514,0.002504,0.002494,0.002485,0.002475,0.002465,0.002456,0.002446,0.002436,0.002426,0.002417,0.002407,0.002397,0.002387,0.002377,0.002367,0.002357,0.002347,0.002338,0.002328,0.002318,0.002308,0.002298,0.002288,0.002278,0.002268,0.002258,0.002248,0.002238,0.002228,0.002217,0.002207,0.002197,0.002187,0.002177,0.002167,0.002157,0.002147,0.002137,0.002126,0.002116,0.002106,0.002096,0.002086,0.002076,0.002065,0.002055,0.002045,0.002035,0.002025,0.002014,0.002004,0.001994,0.001984,0.001974,0.001963,0.001953,0.001943,0.001933,0.001923,0.001912,0.001902,0.001892,0.001882,0.001871,0.001861,0.001851,0.001841,0.001831,0.001821,0.001810,0.001800,0.001790,0.001780,0.001770,0.001760,0.001749,0.001739,0.001729,0.001719,0.001709,0.001699,0.001689,0.001679,0.001669,0.001659,0.001649,0.001639,0.001629,0.001619,0.001609,0.001599,0.001589,0.001579,0.001569,0.001559,0.001549,0.001539,0.001529,0.001519,0.001509,0.001500,0.001490,0.001480,0.001470,0.001460,0.001451,0.001441,0.001431,0.001422,0.001412,0.001402,0.001393,0.001383,0.001373,0.001364,0.001354,0.001345,0.001335,0.001326,0.001316,0.001307,0.001298,0.001288,0.001279,0.001270,0.001260,0.001251,0.001242,0.001233,0.001223,0.001214,0.001205,0.001196,0.001187,0.001178,0.001169,0.001160,0.001151,0.001142,0.001133,0.001124,0.001115,0.001107,0.001098,0.001089,0.001080,0.001072,0.001063,0.001054,0.001046,0.001037,0.001029,0.001020,0.001012,0.001003,0.000995,0.000987,0.000978,0.000970,0.000962,0.000954,0.000946,0.000938,0.000930,0.000921,0.000914,0.000906,0.000898,0.000890,0.000882,0.000874,0.000866,0.000859,0.000851,0.000843,0.000836,0.000828,0.000821,0.000813,0.000806,0.000799,0.000791,0.000784,0.000777,0.000769,0.000762,0.000755,0.000748,0.000741,0.000734,0.000727,0.000720,0.000714,0.000707,0.000700,0.000693,0.000687,0.000680,0.000674,0.000667,0.000661,0.000654,0.000648,0.000641,0.000635,0.000629,0.000623,0.000617,0.000611,0.000605,0.000599,0.000593,0.000587,0.000581,0.000575,0.000570,0.000564,0.000559,0.000553,0.000547,0.000542,0.000537,0.000531,0.000526,0.000521,0.000516,0.000511,0.000505,0.000500,0.000496,0.000491,0.000486,0.000481,0.000476,0.000472,0.000467,0.000462,0.000458,0.000453,0.000449,0.000445,0.000440,0.000436,0.000432,0.000428,0.000424,0.000420,0.000416,0.000412,0.000408,0.000405,0.000401,0.000397,0.000394,0.000390,0.000387,0.000383,0.000380,0.000377,0.000373,0.000370,0.000367,0.000364,0.000361,0.000358,0.000355,0.000352,0.000350,0.000347,0.000344,0.000342,0.000339,0.000337,0.000334,0.000332,0.000330,0.000328,0.000325,0.000323,0.000321,0.000319,0.000317,0.000316,0.000314,0.000312,0.000310,0.000309,0.000307,0.000306,0.000304,0.000303,0.000302,0.000301,0.000299,0.000298,0.000297,0.000296,0.000295,0.000295,0.000294,0.000293,0.000292,0.000292,0.000291,0.000291,0.000290,0.000290,0.000290,0.000290,0.000289,0.000289};
//float window[1024]={0.0289,0.0289,0.0289,0.0290,0.0290,0.0290,0.0290,0.0291,0.0291,0.0292,0.0292,0.0293,0.0294,0.0295,0.0295,0.0296,0.0297,0.0298,0.0299,0.0301,0.0302,0.0303,0.0304,0.0306,0.0307,0.0309,0.0310,0.0312,0.0314,0.0316,0.0317,0.0319,0.0321,0.0323,0.0325,0.0328,0.0330,0.0332,0.0334,0.0337,0.0339,0.0342,0.0344,0.0347,0.0350,0.0352,0.0355,0.0358,0.0361,0.0364,0.0367,0.0370,0.0373,0.0377,0.0380,0.0383,0.0387,0.0390,0.0394,0.0397,0.0401,0.0405,0.0408,0.0412,0.0416,0.0420,0.0424,0.0428,0.0432,0.0436,0.0440,0.0445,0.0449,0.0453,0.0458,0.0462,0.0467,0.0472,0.0476,0.0481,0.0486,0.0491,0.0496,0.0500,0.0505,0.0511,0.0516,0.0521,0.0526,0.0531,0.0537,0.0542,0.0547,0.0553,0.0559,0.0564,0.0570,0.0575,0.0581,0.0587,0.0593,0.0599,0.0605,0.0611,0.0617,0.0623,0.0629,0.0635,0.0641,0.0648,0.0654,0.0661,0.0667,0.0674,0.0680,0.0687,0.0693,0.0700,0.0707,0.0714,0.0720,0.0727,0.0734,0.0741,0.0748,0.0755,0.0762,0.0769,0.0777,0.0784,0.0791,0.0799,0.0806,0.0813,0.0821,0.0828,0.0836,0.0843,0.0851,0.0859,0.0866,0.0874,0.0882,0.0890,0.0898,0.0906,0.0914,0.0921,0.0930,0.0938,0.0946,0.0954,0.0962,0.0970,0.0978,0.0987,0.0995,0.1003,0.1012,0.1020,0.1029,0.1037,0.1046,0.1054,0.1063,0.1072,0.1080,0.1089,0.1098,0.1107,0.1115,0.1124,0.1133,0.1142,0.1151,0.1160,0.1169,0.1178,0.1187,0.1196,0.1205,0.1214,0.1223,0.1233,0.1242,0.1251,0.1260,0.1270,0.1279,0.1288,0.1298,0.1307,0.1316,0.1326,0.1335,0.1345,0.1354,0.1364,0.1373,0.1383,0.1393,0.1402,0.1412,0.1422,0.1431,0.1441,0.1451,0.1460,0.1470,0.1480,0.1490,0.1500,0.1509,0.1519,0.1529,0.1539,0.1549,0.1559,0.1569,0.1579,0.1589,0.1599,0.1609,0.1619,0.1629,0.1639,0.1649,0.1659,0.1669,0.1679,0.1689,0.1699,0.1709,0.1719,0.1729,0.1739,0.1749,0.1760,0.1770,0.1780,0.1790,0.1800,0.1810,0.1821,0.1831,0.1841,0.1851,0.1861,0.1871,0.1882,0.1892,0.1902,0.1912,0.1923,0.1933,0.1943,0.1953,0.1963,0.1974,0.1984,0.1994,0.2004,0.2014,0.2025,0.2035,0.2045,0.2055,0.2065,0.2076,0.2086,0.2096,0.2106,0.2116,0.2126,0.2137,0.2147,0.2157,0.2167,0.2177,0.2187,0.2197,0.2207,0.2217,0.2228,0.2238,0.2248,0.2258,0.2268,0.2278,0.2288,0.2298,0.2308,0.2318,0.2328,0.2338,0.2347,0.2357,0.2367,0.2377,0.2387,0.2397,0.2407,0.2417,0.2426,0.2436,0.2446,0.2456,0.2465,0.2475,0.2485,0.2494,0.2504,0.2514,0.2523,0.2533,0.2542,0.2552,0.2561,0.2571,0.2580,0.2590,0.2599,0.2609,0.2618,0.2627,0.2637,0.2646,0.2655,0.2664,0.2674,0.2683,0.2692,0.2701,0.2710,0.2719,0.2728,0.2737,0.2746,0.2755,0.2764,0.2773,0.2782,0.2791,0.2800,0.2808,0.2817,0.2826,0.2835,0.2843,0.2852,0.2860,0.2869,0.2877,0.2886,0.2894,0.2903,0.2911,0.2919,0.2928,0.2936,0.2944,0.2952,0.2961,0.2969,0.2977,0.2985,0.2993,0.3001,0.3009,0.3016,0.3024,0.3032,0.3040,0.3048,0.3055,0.3063,0.3070,0.3078,0.3085,0.3093,0.3100,0.3108,0.3115,0.3122,0.3130,0.3137,0.3144,0.3151,0.3158,0.3165,0.3172,0.3179,0.3186,0.3193,0.3200,0.3206,0.3213,0.3220,0.3226,0.3233,0.3239,0.3246,0.3252,0.3258,0.3265,0.3271,0.3277,0.3283,0.3289,0.3296,0.3302,0.3307,0.3313,0.3319,0.3325,0.3331,0.3337,0.3342,0.3348,0.3353,0.3359,0.3364,0.3370,0.3375,0.3380,0.3385,0.3391,0.3396,0.3401,0.3406,0.3411,0.3416,0.3420,0.3425,0.3430,0.3435,0.3439,0.3444,0.3448,0.3453,0.3457,0.3461,0.3466,0.3470,0.3474,0.3478,0.3482,0.3486,0.3490,0.3494,0.3498,0.3502,0.3505,0.3509,0.3513,0.3516,0.3520,0.3523,0.3526,0.3530,0.3533,0.3536,0.3539,0.3542,0.3545,0.3548,0.3551,0.3554,0.3557,0.3559,0.3562,0.3565,0.3567,0.3569,0.3572,0.3574,0.3576,0.3579,0.3581,0.3583,0.3585,0.3587,0.3589,0.3591,0.3592,0.3594,0.3596,0.3597,0.3599,0.3600,0.3602,0.3603,0.3604,0.3606,0.3607,0.3608,0.3609,0.3610,0.3611,0.3612,0.3612,0.3613,0.3614,0.3614,0.3615,0.3615,0.3616,0.3616,0.3616,0.3617,0.3617,0.3617,0.3617,0.3617,0.3617,0.3617,0.3616,0.3616,0.3616,0.3615,0.3615,0.3614,0.3614,0.3613,0.3612,0.3612,0.3611,0.3610,0.3609,0.3608,0.3607,0.3606,0.3604,0.3603,0.3602,0.3600,0.3599,0.3597,0.3596,0.3594,0.3592,0.3591,0.3589,0.3587,0.3585,0.3583,0.3581,0.3579,0.3576,0.3574,0.3572,0.3569,0.3567,0.3565,0.3562,0.3559,0.3557,0.3554,0.3551,0.3548,0.3545,0.3542,0.3539,0.3536,0.3533,0.3530,0.3526,0.3523,0.3520,0.3516,0.3513,0.3509,0.3505,0.3502,0.3498,0.3494,0.3490,0.3486,0.3482,0.3478,0.3474,0.3470,0.3466,0.3461,0.3457,0.3453,0.3448,0.3444,0.3439,0.3435,0.3430,0.3425,0.3420,0.3416,0.3411,0.3406,0.3401,0.3396,0.3391,0.3385,0.3380,0.3375,0.3370,0.3364,0.3359,0.3353,0.3348,0.3342,0.3337,0.3331,0.3325,0.3319,0.3313,0.3307,0.3302,0.3296,0.3289,0.3283,0.3277,0.3271,0.3265,0.3258,0.3252,0.3246,0.3239,0.3233,0.3226,0.3220,0.3213,0.3206,0.3200,0.3193,0.3186,0.3179,0.3172,0.3165,0.3158,0.3151,0.3144,0.3137,0.3130,0.3122,0.3115,0.3108,0.3100,0.3093,0.3085,0.3078,0.3070,0.3063,0.3055,0.3048,0.3040,0.3032,0.3024,0.3016,0.3009,0.3001,0.2993,0.2985,0.2977,0.2969,0.2961,0.2952,0.2944,0.2936,0.2928,0.2919,0.2911,0.2903,0.2894,0.2886,0.2877,0.2869,0.2860,0.2852,0.2843,0.2835,0.2826,0.2817,0.2808,0.2800,0.2791,0.2782,0.2773,0.2764,0.2755,0.2746,0.2737,0.2728,0.2719,0.2710,0.2701,0.2692,0.2683,0.2674,0.2664,0.2655,0.2646,0.2637,0.2627,0.2618,0.2609,0.2599,0.2590,0.2580,0.2571,0.2561,0.2552,0.2542,0.2533,0.2523,0.2514,0.2504,0.2494,0.2485,0.2475,0.2465,0.2456,0.2446,0.2436,0.2426,0.2417,0.2407,0.2397,0.2387,0.2377,0.2367,0.2357,0.2347,0.2338,0.2328,0.2318,0.2308,0.2298,0.2288,0.2278,0.2268,0.2258,0.2248,0.2238,0.2228,0.2217,0.2207,0.2197,0.2187,0.2177,0.2167,0.2157,0.2147,0.2137,0.2126,0.2116,0.2106,0.2096,0.2086,0.2076,0.2065,0.2055,0.2045,0.2035,0.2025,0.2014,0.2004,0.1994,0.1984,0.1974,0.1963,0.1953,0.1943,0.1933,0.1923,0.1912,0.1902,0.1892,0.1882,0.1871,0.1861,0.1851,0.1841,0.1831,0.1821,0.1810,0.1800,0.1790,0.1780,0.1770,0.1760,0.1749,0.1739,0.1729,0.1719,0.1709,0.1699,0.1689,0.1679,0.1669,0.1659,0.1649,0.1639,0.1629,0.1619,0.1609,0.1599,0.1589,0.1579,0.1569,0.1559,0.1549,0.1539,0.1529,0.1519,0.1509,0.1500,0.1490,0.1480,0.1470,0.1460,0.1451,0.1441,0.1431,0.1422,0.1412,0.1402,0.1393,0.1383,0.1373,0.1364,0.1354,0.1345,0.1335,0.1326,0.1316,0.1307,0.1298,0.1288,0.1279,0.1270,0.1260,0.1251,0.1242,0.1233,0.1223,0.1214,0.1205,0.1196,0.1187,0.1178,0.1169,0.1160,0.1151,0.1142,0.1133,0.1124,0.1115,0.1107,0.1098,0.1089,0.1080,0.1072,0.1063,0.1054,0.1046,0.1037,0.1029,0.1020,0.1012,0.1003,0.0995,0.0987,0.0978,0.0970,0.0962,0.0954,0.0946,0.0938,0.0930,0.0921,0.0914,0.0906,0.0898,0.0890,0.0882,0.0874,0.0866,0.0859,0.0851,0.0843,0.0836,0.0828,0.0821,0.0813,0.0806,0.0799,0.0791,0.0784,0.0777,0.0769,0.0762,0.0755,0.0748,0.0741,0.0734,0.0727,0.0720,0.0714,0.0707,0.0700,0.0693,0.0687,0.0680,0.0674,0.0667,0.0661,0.0654,0.0648,0.0641,0.0635,0.0629,0.0623,0.0617,0.0611,0.0605,0.0599,0.0593,0.0587,0.0581,0.0575,0.0570,0.0564,0.0559,0.0553,0.0547,0.0542,0.0537,0.0531,0.0526,0.0521,0.0516,0.0511,0.0505,0.0500,0.0496,0.0491,0.0486,0.0481,0.0476,0.0472,0.0467,0.0462,0.0458,0.0453,0.0449,0.0445,0.0440,0.0436,0.0432,0.0428,0.0424,0.0420,0.0416,0.0412,0.0408,0.0405,0.0401,0.0397,0.0394,0.0390,0.0387,0.0383,0.0380,0.0377,0.0373,0.0370,0.0367,0.0364,0.0361,0.0358,0.0355,0.0352,0.0350,0.0347,0.0344,0.0342,0.0339,0.0337,0.0334,0.0332,0.0330,0.0328,0.0325,0.0323,0.0321,0.0319,0.0317,0.0316,0.0314,0.0312,0.0310,0.0309,0.0307,0.0306,0.0304,0.0303,0.0302,0.0301,0.0299,0.0298,0.0297,0.0296,0.0295,0.0295,0.0294,0.0293,0.0292,0.0292,0.0291,0.0291,0.0290,0.0290,0.0290,0.0290,0.0289,0.0289};
float window_ready[3096] = {0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000009, 0.000115, 0.000339, 0.000680, 0.001138, 0.001714, 0.002408, 0.003218, 0.004145, 0.005189, 0.006349, 0.007626, 0.009018, 0.010526, 0.012149, 0.013887, 0.015739, 0.017705, 0.019785, 0.021977, 0.024282, 0.026700, 0.029228, 0.031867, 0.034617, 0.037475, 0.040443, 0.043519, 0.046702, 0.049992, 0.053388, 0.056889, 0.060494, 0.064202, 0.068014, 0.071926, 0.075940, 0.080053, 0.084265, 0.088575, 0.092982, 0.097484, 0.102082, 0.106772, 0.111556, 0.116431, 0.121396, 0.126450, 0.131592, 0.136820, 0.142135, 0.147533, 0.153014, 0.158577, 0.164221, 0.169943, 0.175743, 0.181619, 0.187570, 0.193595, 0.199692, 0.205859, 0.212096, 0.218400, 0.224771, 0.231206, 0.237705, 0.244266, 0.250886, 0.257565, 0.264302, 0.271093, 0.277939, 0.284837, 0.291785, 0.298783, 0.305827, 0.312918, 0.320052, 0.327229, 0.334447, 0.341703, 0.348997, 0.356326, 0.363689, 0.371084, 0.378510, 0.385964, 0.393445, 0.400951, 0.408480, 0.416031, 0.423601, 0.431190, 0.438795, 0.446414, 0.454046, 0.461688, 0.469340, 0.476998, 0.484663, 0.492330, 0.500000, 0.507670, 0.515337, 0.523002, 0.530660, 0.538312, 0.545954, 0.553586, 0.561205, 0.568810, 0.576399, 0.583969, 0.591520, 0.599049, 0.606555, 0.614036, 0.621490, 0.628916, 0.636311, 0.643674, 0.651003, 0.658297, 0.665553, 0.672771, 0.679947, 0.687082, 0.694173, 0.701217, 0.708215, 0.715163, 0.722061, 0.728907, 0.735698, 0.742435, 0.749114, 0.755734, 0.762295, 0.768794, 0.775229, 0.781600, 0.787904, 0.794141, 0.800308, 0.806405, 0.812430, 0.818381, 0.824257, 0.830057, 0.835779, 0.841423, 0.846986, 0.852467, 0.857865, 0.863180, 0.868408, 0.873550, 0.878604, 0.883569, 0.888444, 0.893228, 0.897918, 0.902516, 0.907018, 0.911425, 0.915735, 0.919947, 0.924060, 0.928074, 0.931986, 0.935798, 0.939506, 0.943111, 0.946612, 0.950008, 0.953298, 0.956481, 0.959557, 0.962525, 0.965383, 0.968133, 0.970772, 0.973300, 0.975717, 0.978023, 0.980215, 0.982295, 0.984261, 0.986113, 0.987851, 0.989474, 0.990982, 0.992374, 0.993651, 0.994811, 0.995855, 0.996782, 0.997592, 0.998286, 0.998862, 0.999320, 0.999661, 0.999885, 0.999991, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 1.000000, 0.999991, 0.999885, 0.999661, 0.999320, 0.998862, 0.998286, 0.997592, 0.996782, 0.995855, 0.994811, 0.993651, 0.992374, 0.990982, 0.989474, 0.987851, 0.986113, 0.984261, 0.982295, 0.980215, 0.978023, 0.975717, 0.973300, 0.970772, 0.968133, 0.965383, 0.962525, 0.959557, 0.956481, 0.953298, 0.950008, 0.946612, 0.943111, 0.939506, 0.935798, 0.931986, 0.928074, 0.924060, 0.919947, 0.915735, 0.911425, 0.907018, 0.902516, 0.897918, 0.893228, 0.888444, 0.883569, 0.878604, 0.873550, 0.868408, 0.863180, 0.857865, 0.852467, 0.846986, 0.841423, 0.835779, 0.830057, 0.824257, 0.818381, 0.812430, 0.806405, 0.800308, 0.794141, 0.787904, 0.781600, 0.775229, 0.768794, 0.762295, 0.755734, 0.749114, 0.742435, 0.735698, 0.728907, 0.722061, 0.715163, 0.708215, 0.701217, 0.694173, 0.687082, 0.679947, 0.672771, 0.665553, 0.658297, 0.651003, 0.643674, 0.636311, 0.628916, 0.621490, 0.614036, 0.606555, 0.599049, 0.591520, 0.583969, 0.576399, 0.568810, 0.561205, 0.553586, 0.545954, 0.538312, 0.530660, 0.523002, 0.515337, 0.507670, 0.500000, 0.492330, 0.484663, 0.476998, 0.469340, 0.461688, 0.454046, 0.446414, 0.438795, 0.431190, 0.423601, 0.416031, 0.408480, 0.400951, 0.393445, 0.385964, 0.378510, 0.371084, 0.363689, 0.356326, 0.348997, 0.341703, 0.334447, 0.327229, 0.320052, 0.312918, 0.305827, 0.298783, 0.291785, 0.284837, 0.277939, 0.271093, 0.264302, 0.257565, 0.250886, 0.244266, 0.237705, 0.231206, 0.224771, 0.218400, 0.212096, 0.205859, 0.199692, 0.193595, 0.187570, 0.181619, 0.175743, 0.169943, 0.164221, 0.158577, 0.153014, 0.147533, 0.142135, 0.136820, 0.131592, 0.126450, 0.121396, 0.116431, 0.111556, 0.106772, 0.102082, 0.097484, 0.092982, 0.088575, 0.084265, 0.080053, 0.075940, 0.071926, 0.068014, 0.064202, 0.060494, 0.056889, 0.053388, 0.049992, 0.046702, 0.043519, 0.040443, 0.037475, 0.034617, 0.031867, 0.029228, 0.026700, 0.024282, 0.021977, 0.019785, 0.017705, 0.015739, 0.013887, 0.012149, 0.010526, 0.009018, 0.007626, 0.006349, 0.005189, 0.004145, 0.003218, 0.002408, 0.001714, 0.001138, 0.000680, 0.000339, 0.000115, 0.000009, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000};


XIicPs Iic;
//XAxiDma AxiDma_fft;
XAxiDma AxiDma_i2s;
//XAxiDma AxiDma_mul;

#define PAYLOAD_SIZE 128


struct desc {
	u32 inaddr;
	u32 outaddr;
	u32 cmd;
	u32 padding;
};

#define S2MM_FLAG 0
#define MM2S_FLAG 1
#define RWBOTH_FLAG 2

int getBatchSample(u64 * buf)
{
	u32 channel = 2;
	struct desc tmpdesc;
	tmpdesc.inaddr = 0;
	tmpdesc.outaddr = (u32)buf;
	tmpdesc.cmd = (channel << 18) | ((MAX_PKT_LEN*8) << 2) | S2MM_FLAG;
	tmpdesc.padding = 0;

	u32 *initreg = (u32 *)(0x43C20000);
	memcpy(initreg, &tmpdesc, 16);
//	int Status;
//	//retrieve data from I2S.
//	//only contains right channel data !!
//	Status = XAxiDma_SimpleTransfer(&AxiDma_i2s,(UINTPTR) buf,
//				MAX_PKT_LEN*8, XAXIDMA_DEVICE_TO_DMA);
//
//	if (Status != XST_SUCCESS) {
//		return XST_FAILURE;
//	}
	while ((XAxiDma_Busy(&AxiDma_i2s,XAXIDMA_DEVICE_TO_DMA))){
					/* Wait */
			}
	return XST_SUCCESS;
}

int pushBatchSample(u64 * buf)
{
//	int Status;
//	//TO AUDIO
//	Status = XAxiDma_SimpleTransfer(&AxiDma_i2s,(UINTPTR)sampledata,
//				MAX_PKT_LEN*8, XAXIDMA_DMA_TO_DEVICE);
//
//	if (Status != XST_SUCCESS) {
//		return XST_FAILURE;
//	}
//
//	while ((XAxiDma_Busy(&AxiDma_i2s,XAXIDMA_DMA_TO_DEVICE))) {
//			/* Wait */
//	}
	u32 channel = 2;
	struct desc tmpdesc;
	tmpdesc.inaddr = (u32)buf;
	tmpdesc.outaddr = 0;
	tmpdesc.cmd = (channel << 18) | ((MAX_PKT_LEN*8) << 2) | MM2S_FLAG;
	tmpdesc.padding = 0;

	u32 *initreg = (u32 *)(0x43C20000);
	memcpy(initreg, &tmpdesc, 16);

	//TO AUDIO

	while ((XAxiDma_Busy(&AxiDma_i2s,XAXIDMA_DMA_TO_DEVICE))) {
			/* Wait */
	}
}

int mulHannmingWindow(u64 * bufin, u64 * bufout)
{
	u32 channel = 1;
	struct desc tmpdesc;

	tmpdesc.inaddr = (u32)bufin;
	tmpdesc.outaddr = (u32)bufout;
	tmpdesc.cmd = (channel << 18) | ((MAX_PKT_LEN*8) << 2) | RWBOTH_FLAG;
	tmpdesc.padding = 0;

	u32 *initreg = (u32 *)(0x43C20000);
	memcpy(initreg, &tmpdesc, 16);


	while ((XAxiDma_Busy(&AxiDma_i2s,XAXIDMA_DEVICE_TO_DMA)) ||
		(XAxiDma_Busy(&AxiDma_i2s,XAXIDMA_DMA_TO_DEVICE))) {
			/* Wait */
	}
}

//
int audio_watermark_frame()
{
	int Status;
	u32 *fftctrl = (u32 *)XPAR_FFT_CTRL_0_S00_AXI_BASEADDR;
	u32 *i2sctrl = (u32 *)XPAR_AUDIO_FIFO2STREAM_V2_0_BASEADDR;

	getBatchSample(sampledata);

//	pushBatchSample(sampledata);
	mulHannmingWindow(sampledata, sampledata_modify);
	//getBatchDelta(up, down, sampledata_modify, delta_out);



}


//定时器初始化程序
int timer_init(XScuTimer *timer_ptr)
{
    int status;
    //私有定时器初始化
    XScuTimer_Config *timer_cfg_ptr;
    timer_cfg_ptr = XScuTimer_LookupConfig(TIMER_DEVICE_ID);
    if (NULL == timer_cfg_ptr)
        return XST_FAILURE;
    status = XScuTimer_CfgInitialize(timer_ptr, timer_cfg_ptr,
            timer_cfg_ptr->BaseAddr);
    if (status != XST_SUCCESS)
        return XST_FAILURE;

    XScuTimer_LoadTimer(timer_ptr, TIMER_LOAD_VALUE); // 加载计数周期
    XScuTimer_EnableAutoReload(timer_ptr);            // 设置自动装载模式

    return XST_SUCCESS;
}
static int countdown_step = 6;
//中断处理
void axi_rtc_handler(void *CallbackRef)
{

}

//定时器中断初始化
void timer_intr_init(XScuGic *intc_ptr,XScuTimer *timer_ptr)
{
    //初始化中断控制器
    XScuGic_Config *intc_cfg_ptr;
    intc_cfg_ptr = XScuGic_LookupConfig(INTC_DEVICE_ID);
    XScuGic_CfgInitialize(intc_ptr, intc_cfg_ptr,
            intc_cfg_ptr->CpuBaseAddress);
    //设置并打开中断异常处理功能
    Xil_ExceptionRegisterHandler(XIL_EXCEPTION_ID_INT,
            (Xil_ExceptionHandler)XScuGic_InterruptHandler, intc_ptr);
    Xil_ExceptionEnable();

    //设置定时器中断
    XScuGic_Connect(intc_ptr, TIMER_IRPT_INTR,
          (Xil_ExceptionHandler)axi_rtc_handler, (void *)timer_ptr);

    XScuGic_Enable(intc_ptr, TIMER_IRPT_INTR); //使能GIC中的定时器中断
    XScuTimer_EnableInterrupt(timer_ptr);      //使能定时器中断
}



int main(void)
{
	Xil_DCacheDisable();



	//Configure the IIC data structure
	IicConfig(XPAR_XIICPS_0_DEVICE_ID);
	//Configure the Audio Codec's PLL
	AudioPllConfig();

	//Configure all audio registers
	//AudioConfigureJacks();
	LineinLineoutConfig();

	//DMA Config
	//XAxiDma_Config *CfgPtr;
	XAxiDma_Config *CfgPtr1;
	//XAxiDma_Config *CfgPtr2;

	int Status;
//	CfgPtr = XAxiDma_LookupConfig(DMAFFT_DEV_ID);
//	if (!CfgPtr) {
//		xil_printf("No config found for %d\r\n", DMAFFT_DEV_ID);
//		return XST_FAILURE;
//	}
//
//	Status = XAxiDma_CfgInitialize(&AxiDma_fft, CfgPtr);
//	if (Status != XST_SUCCESS) {
//		xil_printf("Initialization failed %d\r\n", Status);
//		return XST_FAILURE;
//	}

	CfgPtr1 = XAxiDma_LookupConfig(DMAI2S_DEV_ID);
	if (!CfgPtr1) {
		xil_printf("No config found for %d\r\n", DMAI2S_DEV_ID);
		return XST_FAILURE;
	}

	Status = XAxiDma_CfgInitialize(&AxiDma_i2s, CfgPtr1);
	if (Status != XST_SUCCESS) {
		xil_printf("Initialization failed %d\r\n", Status);
		return XST_FAILURE;
	}

//	CfgPtr2 = XAxiDma_LookupConfig(DMAMUL_DEV_ID);
//	if (!CfgPtr2) {
//		xil_printf("No config found for %d\r\n", DMAMUL_DEV_ID);
//		return XST_FAILURE;
//	}
//
//	Status = XAxiDma_CfgInitialize(&AxiDma_mul, CfgPtr2);
//	if (Status != XST_SUCCESS) {
//		xil_printf("Initialization failed %d\r\n", Status);
//		return XST_FAILURE;
//	}

	//使能DMA中断
	XAxiDma_IntrEnable(&AxiDma_i2s, XAXIDMA_IRQ_ALL_MASK, XAXIDMA_DMA_TO_DEVICE);
	XAxiDma_IntrEnable(&AxiDma_i2s, XAXIDMA_IRQ_ALL_MASK, XAXIDMA_DEVICE_TO_DMA);



	Status = timer_init(&Timer);     //定时器初始化
	if (Status != XST_SUCCESS) {
		xil_printf("Timer Initial Failed\r\n");
		return XST_FAILURE;
	}
	timer_intr_init(&Intc,&Timer);   //定时器中断初始化
	XScuTimer_Start(&Timer);    //启动定时器

	//settime_pcf8563t(&Iic, 24, 01, 16, 14, 14);


    //对128位水印该值为2226
	//int frames_per_block = mark_sync_frame_count() + mark_data_frame_count();
	//int frame_number=2 * frames_per_block - Params::frames_pad_start;

	//stream audio
	//audio_stream();

	u32 in_left,in_right;
	u32 output;
	unsigned long u32Temp;

	u32 *fftctrl = (u32 *)XPAR_FFT_CTRL_0_S00_AXI_BASEADDR;
	u32 *i2sctrl = (u32 *)XPAR_AUDIO_FIFO2STREAM_V2_0_BASEADDR;
	//inv_flag: *(fftctrl)
	//fftcore_status: *(fftctrl + 2)
	u32 fftcore_status;// = (u32 *)XPAR_FFT_CTRL_0_S00_AXI_BASEADDR + 2;

	/* Disable interrupts, we use polling mode
	 */
//	XAxiDma_IntrDisable(&AxiDma, XAXIDMA_IRQ_ALL_MASK,
//						XAXIDMA_DEVICE_TO_DMA);
//	XAxiDma_IntrDisable(&AxiDma, XAXIDMA_IRQ_ALL_MASK,
//						XAXIDMA_DMA_TO_DEVICE);

	*(i2sctrl) = 3; //enable i2s fifos
	int framecnt = -1;
	int mark_value = 1;
//	int tmn[20];
//	int ttt=0;


	//后续过程：
	//1.每来一组数据，算delta，算出三元组，给queue的rear叠加，把rear剩的叠加上
	//
	//
	//

	while (1){
		audio_watermark_frame();
	}
}

